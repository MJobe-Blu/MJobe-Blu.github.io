<!DOCTYPE html>
<html>

<head>
    <script src="https://js.jotform.com/JotForm.js"></script>
    <script src="https://js.jotform.com/JotFormCustomWidget.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<style>
    /* input 
      styles */
    #sourceString {
        height: 2.5em;
        min-width: 100%;
        max-width: 100%;
        background-color: #fff;
        border-color: #c3cad8 !important;
        color: #2c3345;
        font-size: 1em;
        border-radius: 4px;
        border: 1px solid;
        display: block;
        padding: 0 .625em;
        outline: 0;
        margin: 0;
        text-align: left;
        box-sizing: border-box;
    }
</style>

<body>
    <title>TestTestTestTestTestTestTestTestTestTestTest</title>
    <span id="labelText"></span>
    <input type="text" id="sourceString" class="form-textbox" value="">
    <script type="text/javascript">
        // (function () {
        //     var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        //     po.src = '//js.jotform.com/JotFormCustomWidget.min.js?onload=onLoadCallback';
        //     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        // })();

        var input = $('#sourceString');

        function nwuWidget() {
            // get widget parameters if any
            const delimiter = JFCustomWidget.getWidgetSetting('delimiter');
            const indexToSplitOn = JFCustomWidget.getWidgetSetting('indexToSplitOn');
            // exposed functions
            this.init = init;
            this.getData = getData;
            this.fillConditionValue = fillConditionValue;
            this.setupFieldData = setupFieldData;

            // initialization of the widget
            function init(formData) {

                // send data to Jotform on change input
                input.on('change', function () {
                    JFCustomWidget.sendData(getData());
                    JFCustomWidget.hideWidgetError();
                });
            }

            // fill the value set by conditions
            function fillConditionValue(data) {
                var inputValue = data.value || '';
                input.val(inputValue.split(delimiter.toString())[parseInt(indexToSplitOn)]);
                JFCustomWidget.hideWidgetError();
            }

            function doubleSplit(data) {

            }

            // get widget data
            function getData() {
                var inputValue = input.val();
                return {
                    valid: !!inputValue,
                    value: inputValue.split(delimiter.toString())[parseInt(indexToSplitOn)]
                };
            }

            function setupFieldData() {
                var fields = [
                    {
                        "label": "fillmein",
                        "value": "one"
                    }]
                return fields;
            }

        }
        // always subscribe to ready event and implement widget related code
        // inside callback function , it is the best practice while developing widgets
        JFCustomWidget.subscribe("ready", function (data) {
            var data = document.getElementById('input_97')
            console.log("pass")
            console.log(data)

            //check array

            var label = JFCustomWidget.getWidgetSetting('QuestionLabel');
            document.getElementById('labelText').innerHTML = label;
            var widget = new nwuWidget();
            widget.init(data);

            //this is the submit event to get and return the data to jotform
            JFCustomWidget.subscribe("submit", function () {
                //call APIs
                //JFCustomWidget.sendData(msg);
            });

            //this is if you wish to send data to the widget from elsewhere on the form

            //JFCustomWidget.subscribe('populate', widget.fillConditionValue);

            //this is if you wish to send data to other fields on the form, here using the label of the field

            //JFCustomWidget.setFieldsValueByLabel(widget.setupFieldData);


        });

    </script>
</body>

</html>